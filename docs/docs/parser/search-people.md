# Поиск людей
Функция собирает людей из глобального поиска по заданным критериям с обходом лимита в 1000 пользователей.  Результаты сохраняются в `(Папка проекта)\(SearchUsers)`, а имя результирующего файла генерируется на основании текущей даты и времени (которые установлены на ПК пользователя).

Функция работает в комбинированном режиме. Для начала необходимо выяснить сколько пользователей доступно в поиске по выбранным критериям с использованием локального аккаунта. Это нужно для того, чтобы программа сгенерировала оптимальное количество запросов для обхода ограничения в 1000 человек (подробнее в разделе [Обход лимита VK в 1000 пользователей](#vk-1000)). Если на этом этапе выявится, что программа не может обойти лимит или если результатов по выбранным критериям не более тысячи, то программа сохранит собранных пользователей и задание будет считаться завершенным.

Если же программа может обойти ограничение ВК в 1000 пользователей – то программа генерирует необходимые запросы для нахождения как можно большего количества людей и переходит в режим мультиакка.

## Доступные критерии поиска

### Основные настройки

<table style="width:100%">
  <thead>
    <tr style="background-color:rgb(241, 242, 244)">
      <th style="width:20%">Название</th>
      <th style="width:30%">Тип элемента управления</th>
      <th style="width:50%">Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Ключевые слова</td>
      <td>Поле ввода с кнопкой очистить</td>
      <td>Строка поискового запроса. Например, Вася Бабич. Поиск ключевых слов происходит не только в имени и фамилии, но в профиле пользователя в целом.</td>
    </tr>
    <tr>
      <td>Страна</td>
      <td>Редактируемый выпадающий список</td>
      <td>Страна, указанная у пользователя. Список стран загружается из VK.</td>
    </tr>
    <tr>
      <td>Город</td>
      <td>Редактируемый выпадающий список</td>
      <td>Город, указанный у пользователя. Список городов загружается из VK после выбора Страны. По умолчанию загружаются наиболее крупные и популярные города. Поиск среди остальных городов происходит по мере ввода в это поле первых букв названия города.</td>
    </tr>
    <tr>
      <td>Пол</td>
      <td>Выпадающий список</td>
      <td>Если пол не выбран, то в результатах могут быть как мужчины, так и женщины. По умолчанию пол не выбран.</td>
    </tr>
    <tr>
      <td>Сейчас онлайн</td>
      <td>Чекбокс</td>
      <td>Пользователь в момент поиска должен быть в сети</td>
    </tr>
    <tr>
      <td>С фотографией</td>
      <td>Чекбокс</td>
      <td>У пользователя установлена заглавная фотография</td>
    </tr>
    <tr>
      <td>Статус</td>
      <td>Выпадающий список</td>
      <td>Семейное положение указанное в профиле</td>
    </tr>
    <tr>
      <td>Возраст (от, до)</td>
      <td>Два выпадающих списка</td>
      <td>Диапазон возраста пользователя. По умолчанию любой, в выпадающих списках выбрано значение “- Не важно -”.</td>
    </tr>
    <tr>
      <td>День рождения (день, месяц, год)</td>
      <td>Три выпадающих списка</td>
      <td>Отдельно можно задать день, месяц и год рождения. Данный критерий влияет на итоговое количество найденных программой пользователей. Подробнее см. Обход лимита VK в 1000 пользователей</td>
    </tr>
  </tbody>
</table>

### Настройки университета

<table style="width:100%">
  <thead>
    <tr style="background-color:rgb(241, 242, 244)">
      <th style="width:20%">Название</th>
      <th style="width:30%">Тип элемента управления</th>
      <th style="width:50%">Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Ключевые слова</td>
      <td>Поле ввода с кнопкой очистить</td>
      <td>Строка поискового запроса. Например, Вася Бабич. Поиск ключевых слов происходит не только в имени и фамилии, но в профиле пользователя в целом.</td>
    </tr>
    <tr>
      <td>Ключевые слова</td>
      <td>Поле ввода с кнопкой очистить</td>
      <td>Строка поискового запроса. Например, Вася Бабич. Поиск ключевых слов происходит не только в имени и фамилии, но в профиле пользователя в целом.</td>
    </tr>
    <tr>
      <td>Ключевые слова</td>
      <td>Поле ввода с кнопкой очистить</td>
      <td>Строка поискового запроса. Например, Вася Бабич. Поиск ключевых слов происходит не только в имени и фамилии, но в профиле пользователя в целом.</td>
    </tr>
    <tr>
      <td>Ключевые слова</td>
      <td>Поле ввода с кнопкой очистить</td>
      <td>Строка поискового запроса. Например, Вася Бабич. Поиск ключевых слов происходит не только в имени и фамилии, но в профиле пользователя в целом.</td>
    </tr>
    <tr>
      <td>Ключевые слова</td>
      <td>Поле ввода с кнопкой очистить</td>
      <td>Строка поискового запроса. Например, Вася Бабич. Поиск ключевых слов происходит не только в имени и фамилии, но в профиле пользователя в целом.</td>
    </tr>
  </tbody>
</table>
      

### Настройки школы

<table style="width:100%">
  <thead>
    <tr style="background-color:rgb(241, 242, 244)">
      <th style="width:20%">Название</th>
      <th style="width:30%">Тип элемента управления</th>
      <th style="width:50%">Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Страна</td>
      <td>Редактируемый выпадающий список</td>
      <td>См. описание “Страна” в разделе “Основные настройки”</td>
    </tr>
    <tr>
      <td>Город</td>
      <td>Редактируемый выпадающий список</td>
      <td>См. описание “Город” в разделе “Основные настройки”</td>
    </tr>
    <tr>
      <td>Школа</td>
      <td>Редактируемый выпадающий список</td>
      <td>Школа, которая указана у пользователя в профиле. Список школ загружается для выбранной страны и города из ВК. По умолчанию загружаются наиболее популярные школы. Поиск среди остальных школ происходит по мере ввода в это поле первых символов названия школы.</td>
    </tr>
    <tr>
      <td>Класс</td>
      <td>Буква класса, который указан у пользователя в профиле. Пользователь может ввести в это поле своё значение или выбрать его из списка.</td>
      <td>Строка поискового запроса. Например, Вася Бабич. Поиск ключевых слов происходит не только в имени и фамилии, но в профиле пользователя в целом.</td>
    </tr>
    <tr>
      <td>Год окончания</td>
      <td>Поле ввода, принимает значения от 1900 и до 2100.</td>
      <td>Год окончания школы, указанный в профиле у пользователя.</td>
    </tr>
  </tbody>
</table>

### Дополнительные настройки

<table style="width:100%">
  <thead>
    <tr style="background-color:rgb(241, 242, 244)">
      <th style="width:20%">Название</th>
      <th style="width:30%">Тип элемента управления</th>
      <th style="width:50%">Описание</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Работа</td>
      <td>Поле ввода с кнопкой очистить.</td>
      <td>Строка поискового запроса. Например, Вася Бабич. Поиск ключевых слов происходит не только в имени и фамилии, но в профиле пользователя в целом.</td>
    </tr>
    <tr>
      <td>Должность</td>
      <td>Название компании, в которой работают пользователи.</td>
      <td>Строка поискового запроса. Например, Вася Бабич. Поиск ключевых слов происходит не только в имени и фамилии, но в профиле пользователя в целом.</td>
    </tr>
    <tr>
      <td>Религиозные взгляды</td>
      <td>Редактируемый выпадающий список</td>
      <td>Религиозные взгляды. В списке присутствуют популярные значения, однако пользователь может ввести и своё значение.</td>
    </tr>
  </tbody>
</table>

## Обход лимита VK в 1000 пользователей
